(()=>{"use strict";window.addEventListener("load",(()=>{if(document.querySelector('div[aria-label="ここにプロンプトを入力してください"]')){console.log("%c ★ Gemini Content Script Loaded in TARGET FRAME! ★","color: #42f560; font-size: 16px; font-weight: bold;");const e={INPUT_AREA:'div[aria-label="ここにプロンプトを入力してください"]',SEND_BUTTON:'button[aria-label="プロンプトを送信"]',RESPONSE_CONTAINER:'div[id^="model-response-message-content"]'};let t="",n=null,o=!1,r=null;function c(){if(o)return;const e=document.body;n&&n.disconnect(),o=!0,n=new MutationObserver((()=>{r&&clearTimeout(r),r=window.setTimeout((()=>{const e=s();e&&e!==t&&(console.log("新しい応答を確定し、抽出しました:",e),t=e,l(e),null==n||n.disconnect(),o=!1)}),500)})),n.observe(e,{childList:!0,subtree:!0,characterData:!0,attributes:!0})}function s(){try{const t=document.querySelectorAll(e.RESPONSE_CONTAINER);return 0===t.length?null:(t[t.length-1].textContent||"").trim()}catch(e){return console.error("応答テキストの抽出中にエラーが発生しました:",e),null}}function l(e){const t={status:"success",event:"responseReceived",payload:{text:e}};chrome.runtime.sendMessage(t)}function i(e){const t={status:"error",message:e};chrome.runtime.sendMessage(t)}chrome.runtime.onMessage.addListener(((n,o,r)=>{switch(n.command){case"setInput":(s=n.payload.text,new Promise((t=>{try{const n=document.querySelector(e.INPUT_AREA);if(!n)return console.error("入力欄が見つかりません"),void t(!1);n.focus(),n.textContent=s;const o=new Event("input",{bubbles:!0});n.dispatchEvent(o),t(!0)}catch(e){console.error("テキスト入力中にエラーが発生しました:",e),t(!1)}}))).then((e=>{e||i("テキスト入力に失敗しました")}));break;case"clickSend":new Promise((n=>{let o=0;const r=setInterval((()=>{const s=document.querySelector(e.SEND_BUTTON);if(!s||s.disabled)o++,o>=30&&(clearInterval(r),console.error("送信ボタンが見つからないか、有効になりませんでした"),n(!1));else{clearInterval(r);try{s.click(),t="",c(),n(!0)}catch(e){console.error("送信ボタンクリック中にエラーが発生しました:",e),n(!1)}}}),100)})).then((e=>{e||i("送信ボタンクリックに失敗しました")}))}var s;return!0})),chrome.runtime.sendMessage({type:"content_ready"})}}))})();
//# sourceMappingURL=content.js.map